<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Dashmachine Crypto</title>
  
  <script src="https://unpkg.com/dash"></script>
  <script src="dashmachine-crypto-lib.js" type="text/javascript"></script>

  <script>
    
    const vendorPrivateKey = '40148175614f062fb0b4e5c519be7b6f57b872ebb55ea719376322fd12547bff'
    const message = 'hello';
    const userPubicKey = 'A7GGInyvn7ExXkSVg+OFhbhVjEMhIFv0oyeJl03gFDRo'
    const userPrivateKey = '219c8a8f9376750cee9f06e0409718f2a1b88df4acc61bf9ed9cf252c8602768'
    const vendorPublicKey = 'A0/qSE6tis4l6BtQlTXB2PHW+WV+Iy0rpF5hAvX8hDRz'
    console.log(`Encrypting message "${message}"...`);
    const encrypted = DashmachineCrypto.encrypt(vendorPrivateKey, message, userPubicKey);
    console.dir(encrypted.data);
    console.log(`Decrypting result message "${message}"...`);
    const decrypted = DashmachineCrypto.decrypt(userPrivateKey, encrypted.data, vendorPublicKey);
    console.dir(decrypted);
    console.log(`Hashing message "${message}"...`);
    const digest = DashmachineCrypto.hash(message);
    console.dir(digest.data);
    console.log(`Verifying hash...`);
    const verifies = DashmachineCrypto.verify(message, digest.data);
    console.dir(verifies.success)
    const entropy = DashmachineCrypto.generateEntropy();
    console.log(`entropy: ${entropy}`);
    
/*
    const senderName = 'alice';
    const senderMnemonic = 'uniform analyst paper father soldier toe lesson fetch exhaust jazz swim response';
    const recipientName = 'bob';
    const recipientMnemonic = 'liar fee island situate deal exotic flat direct save bag fiscal news';
    const userMessage = `Hello ${recipientName}!`;
    const dpnsContractId = '295xRRRMGYyAruG39XdAibaU9jMAzxhknkkAxFE7uVkW'

    async function testUsernameEncryption() {
      try {
        console.log(`send message \"${userMessage}\" to user: ${recipientName}`)
        const encrypted = await DashmachineCrypto.encryptForUsername(userMessage, senderName, recipientName, senderMnemonic, dpnsContractId);
        console.log('encrypted:', encrypted.data);
        const decrypted = await DashmachineCrypto.decryptForUsername(encrypted.data, recipientName, senderName, recipientMnemonic, dpnsContractId)
        console.log('decrypted:', decrypted.data);
      }
      catch (e) {
        console.log('error :', e);

      }

    }

    (async () => { await testUsernameEncryption() })()
*/  
  </script>
</head>

<body>
  <div id="test">
  </div>
</body>

</html>